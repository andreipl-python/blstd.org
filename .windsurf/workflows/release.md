---
description: Релиз-воркфлоу
auto_execution_mode: 1
---

Когда пользователь в репозитории `blstd.org` пишет отдельным сообщением `фиксируем` (или `ФИКСИРУЕМ`), ассистент запускает полный релизный воркфлоу для текущих изменений.

## 1. Сбор и обзор изменений

1. Собрать изменения с последнего пуша:
   - просмотреть `git status` (чтобы увидеть изменённые/новые/удалённые файлы);
   - просмотреть `git diff` (чтобы понять суть изменений).
2. Кратко описать пользователю, какие группы изменений готовятся к релизу:
   - новые фичи;
   - багфиксы;
   - рефакторинг/технические правки.

## 2. Выбор версии (MAJOR/MINOR/PATCH) и обновление [VERSION](cci:7://file:///c:/Users/Andrei/PycharmProjects/blstd.org/VERSION:0:0-0:0)

1. Открыть текущий файл [VERSION](cci:7://file:///c:/Users/Andrei/PycharmProjects/blstd.org/VERSION:0:0-0:0) и считать актуальную версию `MAJOR.MINOR.PATCH`.
2. На основе характера изменений (по `git diff` и сути фич/фиксов) выбрать, какую часть версии изменять:
   - **MAJOR** — обратная несовместимость, крупные изменения поведения или API;
   - **MINOR** — новые функции/возможности, не ломающие существующий функционал;
   - **PATCH** — багфиксы, мелкие доработки и рефакторинг без внешнего изменения API/поведения.
3. Сформулировать пользователю предлагаемое изменение версии с обоснованием  
   (например: `1.3.0 → 1.3.1 (PATCH, только багфиксы в оплатах)`).
4. В пограничных случаях явно указать, что ситуация спорная, и запросить подтверждение варианта.
5. После подтверждения пользователя обновить файл [VERSION](cci:7://file:///c:/Users/Andrei/PycharmProjects/blstd.org/VERSION:0:0-0:0) на согласованную версию.

## 3. Подготовка git-команд (add/commit/push)

1. Сформировать набор команд, не выполняя их автоматически:
   - `git add ...` — список файлов, которые должны войти в релиз;
   - `git commit -m "..."` — осмысленное сообщение коммита, соответствующее изменениям;
   - `git push` — отправка изменений в удалённый репозиторий.
2. Показать эти команды пользователю для проверки и ручного запуска (или запуска через подтверждённый инструмент).

## 4. Релиз-ноты (release notes)

1. Сгенерировать человекочитаемый релиз-нот текстом, в духе Notion-шаблона по следующему образцу:
   "### Версия: 1.3.0

Тип изменений: добавление показателя «К оплате» в модальном окне оплаты и исправление логики работы со сценариями бронирования.

Обратная совместимость: обратно совместимо, структура данных не менялась, существующие брони и операции оплаты продолжают работать как раньше.

Что нового

- Модальное окно оплаты — показатель «К оплате»
    - В модальное окно оплаты подгружаются данные брони (стоимость, уже внесённые платежи, остаток к оплате) через эндпоинт /booking/get-booking-details/<booking_id>/.
    - Блок «Стоимость / Внесено / Остаток» заполняется актуальными значениями из базы и показывает реальный остаток к оплате.
    - Данные обновляются при каждом открытии модального окна оплаты, чтобы учитывать новые платежи.
- Внутренние изменения — сценарии бронирования
    - Во вьюхах, связанных с оплатой и деталями брони, переход с несуществующего поля reservation_type на корректное поле scenario.
    - Подписки (Subscription), тарифные единицы (TariffUnit) и доступность специалистов теперь определяются через scenario, что предотвращает ошибки 400 при получении деталей брони."

   - краткий список изменений по блокам (например, `Функциональность`, `UI/UX`, `Багфиксы`, `Техдолг/рефакторинг`);
   - без дублирования статусов задач и спринтов из `planning/*.md`  
     (в релиз-ноте нужен только краткий перечень изменений, а не управление задачами).
2. Вывести готовый текст так, чтобы пользователь мог напрямую скопировать его в Notion.
