# CRM Project Plan

## 1. UI/UX: Основные экраны и взаимодействия

- **Главная страница**
  - [High · Ожидание дизайнера] Дизайн календаря (ждём от дизайнера)

- **Фильтры и списки**
  - [High · 1 h] Поведение списка клиентов: 10 строк, скролл, ранжировка по алфавиту

- **Календарь и таблица**
  - [High · 6 h · ожидание решения заказчика] Пошаговая загрузка календаря по дням вместо оверлея (моментальная отрисовка дня и его броней, затем следующих дней)

- **Окно авторизации**
  - [High · 1 h] Шаблон окна авторизации (базовая вёрстка)
  - [Medium · 1 h] Перенос дизайна окна авторизации из Figma

- **Модальные окна**
  - **Добавление абонемента**
    - [High · 2 h] Шаблон модального окна добавления абонемента
    - [Medium · 1 h] Перенос дизайна модального окна добавления абонемента из Figma
    - [High · 2 h] Сценарно‑зависимый шаблон модалки добавления абонемента (Музыкальная школа / Репетиционная точка / Музыкальный класс)
    - [Medium · 2 h] В модалке добавления абонемента для «Репетиционная точка» и «Музыкальный класс»: селект «Клиент/Группа» вместо «Клиент»
  - **Абонементы клиента (информация)**
    - [High · 2 h] Шаблон модального окна «Абонементы клиента» (список абонементов, пометка «групповой»)

  - **Создание бронирований (массовое)**
    - [High · 2 h] Проработка формы создания бронирований: разделение общих и блочных полей (клиент, комната, направление, специалист — общие; дата, время, длительность, доп. услуги, комментарий — в блоке), лимит 3 блока, копирование предыдущего блока, правила удаления, отображение ошибок по блокам
    - [High · 4 h] UI добавления нескольких блоков в модалке создания: кнопка добавления, копирование предыдущего блока, лимит 3 блока, удаление, заголовки блоков
    - [High · 4 h] Модель данных формы в виде массива блоков: синхронизация общих полей, независимые поля блоков, корректная сборка запроса
    - [High · 6 h] Поля и логика внутри блока массовой брони в зависимости от сценария (3 сценария): разные наборы полей, селекты, инициализация и переинициализация
    - [High · 3 h] Обработка ответа создания нескольких бронирований: привязка ошибок к конкретному блоку и полю, подсветка, прокрутка к первой ошибке, блокировка отправки
    - [Medium · 2 h] Интеграция после успешного создания массовой брони: обновление календаря и счетчиков, закрытие модального окна, уведомление об успехе

## 2. Функциональность и бизнес-логика

- **Бронирования и расписание**
  - [Medium · 2 h] Багфикс: восстановить предупреждение времени начала при сбросе длительности (создание/редактирование)
  - [High · 1 h] Контракт создания нескольких бронирований: формат запроса с массивом блоков и формат ответа с ошибками по номеру блока и полю
  - [High · 3 h] Backend: endpoint создания нескольких бронирований (без поломки одиночного создания), настройка URL и прав доступа
  - [High · 4 h] Backend: серверная проверка каждого блока массовой брони с учетом сценария (3 сценария — разные обязательные поля и правила)
  - [High · 8 h] Backend: проверки пересечений и конфликтов массовой брони (комната, специалист, рабочее время) + проверки конфликтов между блоками внутри одной формы
  - [Medium · 1 h] Backend: атомарное создание всех блоков массовой брони (одна транзакция) + единый формат ошибок
  - [Medium · 5 h] Проверки и регрессия массовой брони: одиночное создание не сломано, сценарии с несколькими блоками, конфликты с существующими бронированиями и между блоками, ручной чек-лист

- **Оплаты и биллинг**
  - [Medium · 3 h] В модальном окне оплаты: перенос финального дизайна блока «Итого» из Figma
  - [Medium · 1 h · после макета дизайна] Модальное окно истории оплат: перенос финального дизайна модалки из Figma
  - [High · 8 h] Функционал абонементов и тарифных единиц (модели, расчёт остатка, учёт списаний)
  - [High · 3 h] Оплата тарифными единицами в модальном окне оплаты (списание, проверка балансов)
  - [Medium · 2 h] Функционал модального окна обратной связи после внесения оплаты

- **Клиенты и абонементы**
  - [High · 4 h] Функционал модального окна добавления абонемента (привязка к клиенту, сценарию и срокам)
  - [Medium · 3 h] Модалка добавления абонемента (Репетиционная точка/Музыкальный класс): функционал выбора «Клиент/Группа» (загрузка списка, сохранение, валидации)
  - [Medium · 2 h] Функционал модального окна обратной связи после добавления клиента
  - [High · 10 h] Модель абонемента «Музыкальная школа»: направления (not null, любое количество), услуга специалиста, номинал (кол-во услуг), стоимость, активность, срок действия, название
  - [High · 10 h] Модель абонемента «Репетиционная точка/Музыкальный класс»: тариф, номинал (кол-во тарифов), стоимость, активность, срок действия, название
  - [High · 6 h] Модалка добавления абонемента: сценарная логика (какие поля/модели используются в зависимости от выбранного сценария на главной)
  - [High · 6 h] Информация об абонементах клиента: API/эндпоинт + модалка «Абонементы клиента» (сценарно‑зависимый список)
  - [High · 4 h] Модалки создания/редактирования брони: поле «Абонемент» кликабельно (как история оплат) и открывает «Абонементы клиента»

- **Авторизация и сессии**
  - [High · 3 h] Функционал авторизации по шаблону окна (валидация, создание сессии)

- **Фавикон**
  - [Low · Ожидание от Кирилла] Фавикон (файл пришлёт Кирилл)

- **Деплой и миграция**
  - [High · 4 h] Анализ структуры базы данных старого приложения и разработка стратегии переноса совместно с заказчиком
  - [High · 8 h] Написание скриптов для автоматизации переноса данных из старой БД в новую (с согласованием моделей данных)
  - [High · 6 h] Деплой MVP версии приложения на сервер заказчика (настройка системы, установка служб, настройка бэкапов)
  - [High · 4 h] Перенос данных из старой БД в новую БД и первичная проверка корректности

## 3. Аналитика и отчётность

- [Medium · Ожидание данных] Черновик структуры аналитики (получить от Кирилла)
